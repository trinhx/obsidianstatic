"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[133],{4133:function(e,t,s){s.r(t),s.d(t,{diagram:function(){return _}});var r=s(6149),i=s(7058),a=s(2488),l=s(7237),o=s(4848),d=s(6914),n=s(249);s(7856),s(7484),s(4595),s(4273),s(7967);let c="rect",p="rectWithTitle",g="statediagram",b=`${g}-state`,h="transition",u=`${h} note-edge`,y=`${g}-note`,f=`${g}-cluster`,w=`${g}-cluster-alt`,x="parent",$="note",m="----",T=`${m}${$}`,S=`${m}${x}`,k="fill:none",D="fill: #333",A="text",v="normal",B={},E=0;function N(e="",t=0,s="",r=m){let i=null!==s&&s.length>0?`${r}${s}`:"";return`state-${e}${i}-${t}`}let C=(e,t,s,i,a,o)=>{var d;let n=s.id,g=null==(d=i[n])?"":d.classes?d.classes.join(" "):"";if("root"!==n){let t=c;!0===s.start&&(t="start"),!1===s.start&&(t="end"),s.type!==r.a&&(t=s.type),B[n]||(B[n]={id:n,shape:t,description:l.d.sanitizeText(n,(0,l.g)()),classes:`${g} ${b}`});let i=B[n];s.description&&(Array.isArray(i.description)?(i.shape=p,i.description.push(s.description)):i.description.length>0?(i.shape=p,i.description===n?i.description=[s.description]:i.description=[i.description,s.description]):(i.shape=c,i.description=s.description),i.description=l.d.sanitizeTextOrArray(i.description,(0,l.g)())),1===i.description.length&&i.shape===p&&(i.shape=c),!i.type&&s.doc&&(l.l.info("Setting cluster for ",n,V(s)),i.type="group",i.dir=V(s),i.shape=s.type===r.b?"divider":"roundedWithTitle",i.classes=i.classes+" "+f+" "+(o?w:""));let a={labelStyle:"",shape:i.shape,labelText:i.description,classes:i.classes,style:"",id:n,dir:i.dir,domId:N(n,E),type:i.type,padding:15};if(s.note){let t={labelStyle:"",shape:"note",labelText:s.note.text,classes:y,style:"",id:n+T+"-"+E,domId:N(n,E,$),type:i.type,padding:15},r={labelStyle:"",shape:"noteGroup",labelText:s.note.text,classes:i.classes,style:"",id:n+S,domId:N(n,E,x),type:"group",padding:0};E++;let l=n+S;e.setNode(l,r),e.setNode(t.id,t),e.setNode(n,a),e.setParent(n,l),e.setParent(t.id,l);let o=n,d=t.id;"left of"===s.note.position&&(o=t.id,d=n),e.setEdge(o,d,{arrowhead:"none",arrowType:"",style:k,labelStyle:"",classes:u,arrowheadStyle:D,labelpos:"c",labelType:A,thickness:v})}else e.setNode(n,a)}t&&"root"!==t.id&&(l.l.trace("Setting node ",n," to be child of its parent ",t.id),e.setParent(n,t.id)),s.doc&&(l.l.trace("Adding nodes children "),R(e,s,s.doc,i,a,!o))},R=(e,t,s,i,a,o)=>{l.l.trace("items",s),s.forEach(s=>{switch(s.stmt){case r.c:case r.a:C(e,t,s,i,a,o);break;case r.S:{C(e,t,s.state1,i,a,o),C(e,t,s.state2,i,a,o);let r={id:"edge"+E,arrowhead:"normal",arrowTypeEnd:"arrow_barb",style:k,labelStyle:"",label:l.d.sanitizeText(s.description,(0,l.g)()),arrowheadStyle:D,labelpos:"c",labelType:A,thickness:v,classes:h};e.setEdge(s.state1.id,s.state2.id,r,E),E++}}})},V=(e,t=r.e)=>{let s=t;if(e.doc)for(let t=0;t<e.doc.length;t++){let r=e.doc[t];"dir"===r.stmt&&(s=r.value)}return s},_={parser:r.p,db:r.d,renderer:{setConf:function(e){let t=Object.keys(e);for(let s of t)e[s]},getClasses:function(e,t){l.l.trace("Extracting classes"),t.db.clear();try{return t.parser.parse(e),t.db.extract(t.db.getRootDocV2()),t.db.getClasses()}catch(e){return e}},draw:function(e,t,s,p){let b;l.l.info("Drawing state diagram (v2)",t),B={};let h=p.db.getDirection();void 0===h&&(h=r.D);let{securityLevel:u,state:y}=(0,l.g)(),f=y.nodeSpacing||50,w=y.rankSpacing||50;l.l.info(p.db.getRootDocV2()),p.db.extract(p.db.getRootDocV2()),l.l.info(p.db.getRootDocV2());let x=p.db.getStates(),$=new i.k({multigraph:!0,compound:!0}).setGraph({rankdir:V(p.db.getRootDocV2()),nodesep:f,ranksep:w,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}});C($,void 0,p.db.getRootDocV2(),x,p.db,!0),"sandbox"===u&&(b=(0,a.Ys)("#i"+t));let m="sandbox"===u?(0,a.Ys)(b.nodes()[0].contentDocument.body):(0,a.Ys)("body"),T=m.select(`[id="${t}"]`),S=m.select("#"+t+" g");(0,o.r)(S,$,["barb"],g,t),n.u.insertTitle(T,"statediagramTitleText",y.titleTopMargin,p.db.getDiagramTitle());let k=T.node().getBBox(),D=k.width+16,A=k.height+16;T.attr("class",g);let v=T.node().getBBox();(0,d.c)(T,A,D,y.useMaxWidth);let E=`${v.x-8} ${v.y-8} ${D} ${A}`;l.l.debug(`viewBox ${E}`),T.attr("viewBox",E);let N=document.querySelectorAll('[id="'+t+'"] .edgeLabel .label');for(let e of N){let t=e.getBBox(),s=document.createElementNS("http://www.w3.org/2000/svg",c);s.setAttribute("rx",0),s.setAttribute("ry",0),s.setAttribute("width",t.width),s.setAttribute("height",t.height),e.insertBefore(s,e.firstChild)}}},styles:r.s,init:e=>{e.state||(e.state={}),e.state.arrowMarkerAbsolute=e.arrowMarkerAbsolute,r.d.clear()}}}}]);